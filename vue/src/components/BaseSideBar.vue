<script lang="ts" setup>
import { ref } from "vue"
import { useRouter } from "vue-router"
import { useDisplay } from "vuetify"

const props = defineProps<{
	showSideBar: boolean
}>()

const emits = defineEmits<(e: "drawerVisibiltyChanged", val: boolean) => void>()

const router = useRouter()
const routes = router.getRoutes()
const sidebarRoutes = ref(routes.filter((route: any) => !!route.meta.text))
const { lgAndUp } = useDisplay()
</script>

<template>
	<v-navigation-drawer :modelValue="props.showSideBar"
		@update:modelValue="(val) => emits('drawerVisibiltyChanged', val)" class="bg-primary" :permanent="lgAndUp">
		<v-list class="mt-4" color="transparent" data-cy="main-nav">
			<v-list-item v-for="(route, i) in sidebarRoutes" :prepend-icon="(route.meta!.icon as string)"
				:key="i" color="white" active-class="text-white bg-white/10" :to="route.path">
				<v-list-item-title :style="{ fontWeight: 700 }"> {{ (route.meta!.text as string)}}</v-list-item-title>
			</v-list-item>
		</v-list>
		<template v-slot:append>
			<div class="flex flex-col items-center mb-4">
				<div class="text-center w-40 text-sm lowercase">(v.0.4.0)</div>

				<a :class="`text-white hover:underline-white`" class="decoration-underline"  href="https://www.conplement.de/en/impressum-legal-notice" target="_blank">Imprint</a>
			</div>
		</template>
	</v-navigation-drawer>
</template>